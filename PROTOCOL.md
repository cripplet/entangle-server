entangle-server protocol
====

Format
----

A message packet to / from `entangle-server` is expected to have the following format:

```
L:ACK:MSG_ID:CLIENT_ID:AUTH:CMD:ERR:AUX

# example client-side conection request
22::182:::CONN::foobar123

# example server-side connection response
20:1:182:ef893::CONN:0:
```

Note that *each field has arbitrary length*.

* `L` -- The total length of the packet, starting from the `ACK` field and ending at the last character of `AUX`. This does **not** include the `:` delimiter between `L` 
	and `ACK`.
* `ACK` -- Set to `0` or leave empty on a request and set to `1` on a respones.
* `MSG_ID` -- Unique *numeric* message id for each request; this is mirrored on the respones. Client sets `MSG_ID` on initial communication; each subsequent 
	*non-duplicate* request MUST be greater than each previous request. * `CLIENT_ID` -- Unique client id for a client; this is left empty on the original connection 
	request and is filled in by the server.
* `AUTH` -- Client authentication token, set by the client in the initial `CONN` request. If `AUTH` is set, then all future requests by this client MUST include the same 
	token; otherwise, the server will respond with a `DENIED` code. `AUTH` is left blank on all responses.
* `CMD` -- A *word* designating the command. * `ERR` -- A numeric code designating an error. Left blank or set to `0` on no error.
* `AUX` -- Additional data for each command.

In the following protocol definition, `request` refers to the side initiating the command (the client) and `response` refers to the side fulfilling the command (the 
server). Fields which are obvious are left out (see previous explanation of fields for field values). The `error` section refers to the format of a response which cannot 
be fulfilled by the server due to various reasons. A list of possible error codes to be generated by the relevant response is included in this section. In addition, an 
`INVALID` error code can be returned by the server to *any* request if that request has invalid parameters or an incorrect format, OR `DENIED` if the request `AUTH` 
token does not match the token kept on the server.

Connection
----

### Request

| Field | Value |
| ----- | ----- |
| `MSG_ID` | initial message id |
| `CLIENT_ID` | blank |
| `AUTH` | blank or alphanumeric token |
| `CMD` | `CONN` |
| `AUX` | blank or an alphanumeric password |

### Response

| Field | Value |
| ----- | ----- |
| `MSG_ID` | mirrored |
| `CLIENT_ID` | unique client id |
| `AUTH` | blank |
| `CMD` | mirrored |
| `AUX` | blank |

### Error

Possible error codes:

* `DENIED` -- wrong password
* `MAX_CONN` -- server cannot accept client due to resource limitations

| Field | Value |
| ----- | ----- |
| `MSG_ID` | mirrored |
| `CLIENT_ID` | blank |
| `CMD` | mirrored |
| `ERR` | error code |
| `AUX` | blank |

Disconnect
----

### Request

| Field | Value |
| ----- | ----- |
| `CMD` | `DROP` |
| `AUX` | blank |

### Response

| Field | Value |
| ----- | ----- |
| `CMD` | mirrored |
| `AUX` | blank |

### Error

Possible error codes:

* `NO_CLIENT` -- the client id is not recognized

| Field | Value |
| ----- | ----- |
| `CMD` | mirrored |
| `ERR` | error code |
| `AUX` | blank |

Resize
----

Diff
----

Seek
----

Overwrite
----

Insert
----

Erase
----

Error Codes
----

| Code | Designation | description |
| ---- | ----------- | ----------- |
| 0 | `NO_ERR` | no error |
| 1 | `INVALID` | invalid response received |
| 2 | `DENIED` | access denied |
| 4 | `MAX_CONN` | max connections |
| 8 | `NO_CLIENT` | client not found |

| Field | Value |
| ----- | ----- |
| `CLIENT_ID` | |
| `CMD` | |
| `ERR` | |
| `AUX` | |
